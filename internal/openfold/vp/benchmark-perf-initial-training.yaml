
# @package _global_

defaults:
 - /cluster: ngc
 - _self_

cluster:
  walltime: 30m
  docker_image:  nvidian/cvai_bnmo_trng/openfold:nvmain
  total_nodes: 16
  instance: dgxa100.80g.8.norm
  ace: nv-us-east-2
  org: nvidian
  team: cvai_bnmo_trng
  array_type: "PYTORCH"
  datasets:
    /data/open_protein_set/processed: 1612279
    /data/pdb_mmcif/processed: 1612359
  labels:
    - ml___openfold
    - wl___other___drugdiscovery
    - openfold_bionemo_perf

run:
  command :  bcprun -p 8 -c 'python bionemo/examples/protein/openfold/train.py
              model.data.dataset_path=/data
              model.data.realign_when_required=False
              model.train_ds.threading_enabled=False
              ++model.optimisations="{}"
              ++create_dllogger_callbacks=True
              ++dllogger_callbacks_kwargs.warmup=5
              ++dllogger_callbacks_kwargs.json_file=/result/perf.json
              ++trainer.max_steps=100
              ++trainer.num_nodes=16
              ++trainer.devices=8'

  name: ml-model.openfold-bionemo
