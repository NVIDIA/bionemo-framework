time_limit: 3600
script_args:
  # All arguments referenced in the script string must be specified here. Please reference the script arguments by ${kay_name} or {key_name}
  # Arguments not referenced in the script string must have the 'arg' field specified.
  workspace:
    value: /workspace/bionemo2
  model:
    value: esm2
  variant:
    value: pretrain
  precision:
    value: bf16-mixed
  nodes:
    value: 4
  gpus:
    value: 8
  batch_size:
    value: 16
  max_steps:
    value: 50
script: |-
      python /workspace/bionemo2/sub-packages/bionemo-esm2/src/bionemo/esm2/scripts/train_esm2.py \
      --create-tensorboard-logger \
      --wandb-project=${project_name} \
      --train-cluster-path=/data/train_clusters.parquet \
      --train-database-path=/data/train.db \
      --valid-cluster-path=/data/valid_clusters.parquet \
      --valid-database-path=/data/validation.db \
      --micro-batch-size=16 \
      --num-nodes=${num_nodes} \
      --num-gpus=${devices} \
      --val-check-interval=50 \
      --limit-val-batches=1 \
      --result-dir=/result \
      --experiment-name=${experiment_name} \
      --num-steps=${max_steps} \
      --min-seq-length=1024 \
      --max-seq-length=1024 \
      --num-layers=33 \
      --hidden-size=1280 \
      --num-attention-heads=20 \
      --ffn-hidden-size=5120;
