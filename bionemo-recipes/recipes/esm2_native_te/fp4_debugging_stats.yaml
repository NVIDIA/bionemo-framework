example_fp8_tensor_stat_collection:
    enabled: True
    layers:
        # Match the actual linear layers within attention that support FP8 stats
        layer_types: [layernorm_qkv, proj, fc1, fc2]
    transformer_engine:
        # Uncomment once https://github.com/NVIDIA/TransformerEngine/pull/2296 is merged.
        # LogFp4TensorStats:
        #     enabled: True
        #     tensors_struct:
        #     - tensor: activation
        #       stats: [underflows%, scale_inv_min, scale_inv_max, mse]
        #       freq: 10
        #     - tensor: gradient
        #       stats: [underflows%, scale_inv_min, scale_inv_max, mse]
        #       freq: 10
        #     - tensor: weight
        #       stats: [underflows%, scale_inv_min, scale_inv_max, mse]
        #       freq: 10
        LogTensorStats:
          enabled: True
          stats: [max, min, mean, std, l1_norm] #TODO: Can you get underflows% here?
          tensors: [dgrad, wgrad, fprop]
          freq: 1
